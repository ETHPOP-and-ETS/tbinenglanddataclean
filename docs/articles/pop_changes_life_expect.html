<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating UK born mortality and emmigration rates â€¢ TB in England Data Clean</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating UK born mortality and emmigration rates">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TB in England Data Clean</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/make_data.html">Use the package to construct the data</a>
    </li>
    <li>
      <a href="../articles/pop_changes_life_expect.html">Estimating UK born mortality and emmigration rates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/seabbs/tbinenglanddataclean/">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Estimating UK born mortality and emmigration rates</h1>
                        <h4 class="author">Sam Abbott</h4>
            
            <h4 class="date">2019-04-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/seabbs/tbinenglanddataclean/blob/master/vignettes/pop_changes_life_expect.Rmd"><code>vignettes/pop_changes_life_expect.Rmd</code></a></small>
      <div class="hidden name"><code>pop_changes_life_expect.Rmd</code></div>

    </div>

    
    
<div id="estimating-population-changes-in-the-uk-born-population-using-the-ons-and-lfs-data" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-population-changes-in-the-uk-born-population-using-the-ons-and-lfs-data" class="anchor"></a>Estimating Population changes in the UK born population using the ONS, and LFS data</h1>
<div id="outline" class="section level2">
<h2 class="hasAnchor">
<a href="#outline" class="anchor"></a>Outline</h2>
<ul>
<li>Attempt to use estimated population of the UK born to estimate population changes, capturing both mortality and emmigration.</li>
<li>Split by single year of age, and by 5 year age group</li>
<li>Compare results</li>
<li>Restricted analysis to those aged under 85 as high levels of noise above this, and those aged 90+ are represented in a single category making this analysis infeasible.</li>
</ul>
</div>
<div id="implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tbinenglanddataclean)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## data paths - run the making data vignette to get this data locally 
birth_path =<span class="st"> "../data/tb_data/tbinenglanddataclean/england_births.rds"</span>
demo_path =<span class="st"> "../data/tb_data/tbinenglanddataclean/E_ons_lfs_2000_2016.rds"</span>

## read in data
births &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRDS">readRDS</a></span>(birth_path)
demographics &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRDS">readRDS</a></span>(demo_path)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## munge births
births &lt;-<span class="st"> </span>births <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">Year =</span> year, <span class="dt">Births =</span> births, <span class="dt">Data =</span> data) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(<span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Data)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## clean single year
demographics_single_year &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>ungroup <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">Age group (condensed)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(Age)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(CoB <span class="op">%in%</span><span class="st"> "UK born"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>CoB)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## summarise by age group
demographics_5yr &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Year, <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, CoB) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Population =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(Population), <span class="dt">Age =</span> Age[<span class="dv">1</span>]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ungroup <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(Age)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(CoB <span class="op">%in%</span><span class="st"> "UK born"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>CoB)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">estimate_pop_changes &lt;-<span class="st"> </span><span class="cf">function</span>(demographics, births) {
    ##Join dataframes
  demographics &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">full_join</span>(births, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Year"</span>, <span class="st">"Age"</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Births =</span> Births <span class="op">%&gt;%</span>
<span class="st">             </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/replace">replace</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(Births), <span class="dv">0</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span>)

  ## set up age baseline and estimate population changes
  demographics &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age =</span> Age <span class="op">%&gt;%</span>
<span class="st">             </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/replace">replace</a></span>(Age <span class="op">%in%</span><span class="st"> "90+"</span>, <span class="st">"90"</span>) <span class="op">%&gt;%</span>
<span class="st">             </span>as.numeric) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age_baseline =</span> age <span class="op">-</span><span class="st"> </span>(Year <span class="op">-</span><span class="st"> </span><span class="dv">2000</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(age_baseline) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Pop_Change =</span> (<span class="kw">lead</span>(Population) <span class="op">-</span><span class="st"> </span>Population)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(age_baseline)
  
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(demographics)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Estimate for grouped data
demographics_5yr &lt;-<span class="st"> </span><span class="kw">estimate_pop_changes</span>(demographics_5yr, births)

## Estimate for single year data
demographics_single_year &lt;-<span class="st"> </span><span class="kw">estimate_pop_changes</span>(demographics_single_year, births)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">visualise_pop_changes &lt;-<span class="st"> </span><span class="cf">function</span>(demographics, <span class="dt">rate =</span> <span class="ot">FALSE</span>, <span class="dt">scales =</span> <span class="st">"free"</span>) {
  
  <span class="cf">if</span> (rate) {
    demographics &lt;-<span class="st"> </span><span class="kw">mutate</span>(demographics, <span class="dt">Pop_Change =</span> Pop_Change<span class="op">/</span>Population)
  }
  ##  basic plot to visualise
  demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Years =</span> <span class="kw">case_when</span>(Year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2005</span> <span class="op">~</span><span class="st"> "2000-2004"</span>,
                             Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2005</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2010</span> <span class="op">~</span><span class="st"> "2005-2009"</span>,
                             Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2016</span> <span class="op">~</span><span class="st"> "2010-2015"</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/na.fail">na.omit</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(age <span class="op">&lt;</span><span class="st"> </span><span class="dv">85</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(Year)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Pop_Change, <span class="dt">colour =</span> age, <span class="dt">fill =</span> age, 
               <span class="dt">group =</span> age)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Years, <span class="dt">scales =</span> scales) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_minimal</span>()
}</code></pre></div>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<div id="single-year-of-age-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#single-year-of-age-estimates" class="anchor"></a>Single year of age estimates</h3>
<p>Single year of age estimates are to noisy to be useful. This is likely due to varing sampling error between years for the labour force survey. This indicates that the data should only be used with caution to estimate the UK born population. There is little evidence of systematic bias.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">visualise_pop_changes</span>(demographics_single_year)</code></pre></div>
</div>
<div id="year-age-grouped-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#year-age-grouped-estimates" class="anchor"></a>5 year age grouped estimates</h3>
<ul>
<li>Grouping by 5 year age categories reduced the amount of noise we observe in estimated population changes</li>
<li>However it also reduces the number of years with viable data from 2000-2015, to 2000-2011</li>
<li>Evidence of exponential increase in deaths</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">visualise_pop_changes</span>(demographics_5yr)</code></pre></div>
<ul>
<li>Investigating rates we observe some evidence of decreasing mortality over time.</li>
<li>There is also evidence of higher emmigration/mortality in young adults</li>
<li>There is some evidence of an increasing population in those aged 15-19, this may be noise that has not been removed through aggregation. However it may also be due to individuals returning to the UK for education/work once they have reached 18.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">visualise_pop_changes</span>(demographics_5yr, <span class="dt">rate =</span> <span class="ot">TRUE</span>, <span class="dt">scales =</span> <span class="st">"free_y"</span>)</code></pre></div>
</div>
</div>
<div id="conclusions" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusions" class="anchor"></a>Conclusions</h2>
<ul>
<li>Single year of age estimates are too noisy to be used to estimate population changes</li>
<li>When grouped by 5 year age groups more reliable estimates can be made</li>
<li>The inclusion of those emigrating and possibly returning adds complexity that may be difficult to account for in a modelled population</li>
<li>Grouping the data reduces the number of available years of data</li>
<li>It may be more sensible to use mortality estimates for the total English population (as published by ONS) and assume that mortality rates are equivalent in the UK born.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#estimating-population-changes-in-the-uk-born-population-using-the-ons-and-lfs-data">Estimating Population changes in the UK born population using the ONS, and LFS data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#outline">Outline</a></li>
      <li><a href="#implementation">Implementation</a></li>
      <li><a href="#results">Results</a></li>
      <li><a href="#conclusions">Conclusions</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
